# Графический подпольный чат

## Описание

Программа подключается к анонимному чату для обмена кодами, где считывает сообщения и сохраняет их в файл с отметкой времени. 


## Функционал
1. Записывает сообщение из анонимного чата в файл.
2. Отправляет сообщение в анонимный чат.
3. Авторизация
4. Регистрация, сохраняет ник и токен в файл - `user_auth.txt`.
5. Все события и ошибки логируются в файлы `main_log.log` для последующего анализа.

## Пример работы
Регистрация:
![reg](https://github.com/user-attachments/assets/b73a5079-3f98-46ad-9664-3eb6aa4204fd)

Запуск чата:
![chat](https://github.com/user-attachments/assets/6c2a07f1-bbe3-4288-a2a3-98d4d3650a58)


## Архитектура
- `main` - Основной скрипт для запуска окна чата.
- `network/` — модули для чтения и отправки сообщений.
- `service/` — бизнес-логика, авторизация и поддержка соединения.
- `draw/` — графический интерфейс.


## Опции командной строки

| Опция          | Описание                                    | Значение по умолчанию      |
|----------------|---------------------------------------------|----------------------------|
| `--host`       | Хост сервера                               | `minechat.dvmn.org`       |
| `--port`       | Порт сервера                               | 5000 (для чтения), 5050 (для записи) |
| `--history`    | Путь к папке для хранения истории переписки | `minechat`                 |
| `--token`      | Токен пользователя                         | Подгружается из `.env` (переменная `USER_TOKEN`), если не указан |

---

## Требования

- Python 3.11+
- Зависимости из `requirements.txt` (asyncio, tkinter, anyio, environs, aiofiles)

## Начало работы

1. Клонируйте репозиторий:
```bash
git clone <URL>
```

2. Установите зависимости:
```bash
python -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

3. Необходимо создать .env файл:
```bash
USER_TOKEN=ВашТокен # если есть
HOST=minechat.dvmn.org # по умолчанию
READ_PORT=5000 # по умолчанию
SEND_PORT=5050 # по умолчанию
HISTORY=minechat # папка для истории переписки
```
Остальные параметры установлены под подключение к чату по умолчанию.



6. Запуск чата/регистрации.
    
    Если вы еще не зарегистрированы (п. 6.1), то выполните регистрацию, затем в полученном файле `user_auth.txt` скопируйте токен и запустите (п.6.2)
    
    - 6.1 запуск для регистрации (в появившемся окне предложен ввести ник): `python -m service.registration`

    - 6.2 запуск с обязательным параметром `--token`: `python main.py --token <Ваш токен>`

## Логирование

Все события и ошибки записываются в папку `logger_files` в файлы:

- `main_log.txt` — основной лог
- `watch_log.txt` — лог состояния соединения
